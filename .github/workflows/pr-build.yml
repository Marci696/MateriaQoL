name: PR Build (validation)

on:
    pull_request:

permissions:
    contents: read

jobs:
    build:
        runs-on: windows-2022
        
        steps:
            - name: Checkout
              uses: actions/checkout@v5
              with:
                  submodules: recursive

            - name: Install .NET
              uses: actions/setup-dotnet@v5
              with:
                  dotnet-version: 10.0.x

            - name: Download Dalamud (for build)
              shell: pwsh
              run: |
                  Invoke-WebRequest -Uri https://goatcorp.github.io/dalamud-distrib/latest.zip -OutFile latest.zip
                  Expand-Archive -Force latest.zip "$env:AppData\XIVLauncher\addon\Hooks\dev"

            - name: Build (Release)
              shell: pwsh
              run: dotnet build --configuration Release

            - name: Upload artifact
              uses: actions/upload-artifact@v4
              with:
                  name: MateriaQoL-PR
                  path: .\MateriaQoL\bin\x64\Release\MateriaQoL\*
                  if-no-files-found: error
                  retention-days: 7
